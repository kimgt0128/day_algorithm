WITH JULY_TOTAL AS (
    SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL
    FROM JULY
    GROUP BY FLAVOR
),
 HALF_TOTAL AS (
    SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL
    FROM FIRST_HALF
    GROUP BY FLAVOR
),
ALL_TOTAL AS (
    SELECT H.FLAVOR, H.TOTAL + J.TOTAL AS SUM
    
    FROM HALF_TOTAL H
    
    JOIN JULY_TOTAL J ON H.FLAVOR = J.FLAVOR
    
    ORDER BY SUM DESC
)

SELECT FLAVOR

FROM ALL_TOTAL

LIMIT 3;





